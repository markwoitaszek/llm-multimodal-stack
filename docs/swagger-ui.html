<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multimodal LLM Stack API Documentation</title>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui.css" />
    <link rel="icon" type="image/png" href="https://unpkg.com/swagger-ui-dist@5.9.0/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="https://unpkg.com/swagger-ui-dist@5.9.0/favicon-16x16.png" sizes="16x16" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin:0;
            background: #fafafa;
        }
        .swagger-ui .topbar {
            background-color: #2c3e50;
        }
        .swagger-ui .topbar .download-url-wrapper {
            display: none;
        }
        .service-selector {
            position: fixed;
            top: 10px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .service-selector select {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 14px;
        }
        .api-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
        }
        .api-info h1 {
            margin: 0 0 10px 0;
            font-size: 2.5em;
        }
        .api-info p {
            margin: 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .service-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .service-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .service-card:hover {
            transform: translateY(-5px);
        }
        .service-card h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        .service-card .port {
            background: #3498db;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 0.8em;
            display: inline-block;
            margin-bottom: 10px;
        }
        .service-card p {
            margin: 0 0 15px 0;
            color: #666;
        }
        .service-card a {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 5px;
            font-size: 0.9em;
        }
        .service-card a:hover {
            background: #2980b9;
        }
        .quick-start {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .quick-start h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 10px 0;
        }
        .endpoint-example {
            background: #f1f3f4;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 5px 5px 0;
        }
        .endpoint-example h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        .endpoint-example .method {
            background: #27ae60;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .endpoint-example .url {
            font-family: 'Courier New', monospace;
            color: #2c3e50;
            margin-left: 10px;
        }
        @media (max-width: 768px) {
            .service-selector {
                position: relative;
                top: auto;
                right: auto;
                margin: 10px;
            }
            .api-info h1 {
                font-size: 2em;
            }
            .service-cards {
                grid-template-columns: 1fr;
            }
            .quick-start {
                padding: 15px;
            }
            .endpoint-example {
                padding: 10px;
            }
            .code-block {
                font-size: 0.8em;
                padding: 10px;
                overflow-x: auto;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }
            .api-info {
                padding: 15px;
            }
            .api-info h1 {
                font-size: 1.8em;
            }
            .api-info p {
                font-size: 1em;
            }
            .service-cards {
                gap: 15px;
            }
            .service-card {
                padding: 15px;
            }
            .service-card h3 {
                font-size: 1.2em;
            }
            .quick-start h3 {
                font-size: 1.3em;
            }
            .endpoint-example h4 {
                font-size: 1.1em;
            }
            .code-block {
                font-size: 0.75em;
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="service-selector">
        <label for="service-select">Select Service:</label>
        <select id="service-select">
            <option value="combined">All Services (Combined)</option>
            <option value="litellm-router">LiteLLM Router</option>
            <option value="multimodal-worker">Multimodal Worker</option>
            <option value="retrieval-proxy">Retrieval Proxy</option>
            <option value="ai-agents">AI Agents</option>
        </select>
    </div>

    <div id="swagger-ui"></div>

    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    <script>
        // Service configurations
        const services = {
            'combined': {
                url: './openapi/combined.yaml',
                title: 'Multimodal LLM Stack API',
                description: 'Complete API documentation for all services'
            },
            'litellm-router': {
                url: './openapi/litellm-router.yaml',
                title: 'LiteLLM Router API',
                description: 'OpenAI-compatible API router'
            },
            'multimodal-worker': {
                url: './openapi/multimodal-worker.yaml',
                title: 'Multimodal Worker API',
                description: 'Image, video, and text processing service'
            },
            'retrieval-proxy': {
                url: './openapi/retrieval-proxy.yaml',
                title: 'Retrieval Proxy API',
                description: 'Unified search and context bundling service'
            },
            'ai-agents': {
                url: './openapi/ai-agents.yaml',
                title: 'AI Agents API',
                description: 'LangChain-based autonomous agents'
            }
        };

        // Initialize Swagger UI
        function initSwaggerUI(serviceKey) {
            const service = services[serviceKey];
            
            const ui = SwaggerUIBundle({
                url: service.url,
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl
                ],
                layout: "StandaloneLayout",
                tryItOutEnabled: true,
                requestInterceptor: (request) => {
                    // Add CORS headers for local development
                    request.headers['Access-Control-Allow-Origin'] = '*';
                    request.headers['Access-Control-Allow-Methods'] = 'GET, POST, PUT, DELETE, OPTIONS';
                    request.headers['Access-Control-Allow-Headers'] = 'Content-Type, Authorization';
                    return request;
                },
                responseInterceptor: (response) => {
                    return response;
                },
                onComplete: () => {
                    // Add custom content after Swagger UI loads
                    addCustomContent(service);
                }
            });
        }

        // Add custom content to the page
        function addCustomContent(service) {
            const swaggerContainer = document.getElementById('swagger-ui');
            
            // Create custom header
            const customHeader = document.createElement('div');
            customHeader.innerHTML = `
                <div class="api-info">
                    <h1>${service.title}</h1>
                    <p>${service.description}</p>
                </div>
                
                <div class="service-cards">
                    <div class="service-card">
                        <div class="port">Port 4000</div>
                        <h3>LiteLLM Router</h3>
                        <p>OpenAI-compatible API router for chat completions and model management</p>
                        <a href="#" onclick="switchService('litellm-router')">View API</a>
                    </div>
                    <div class="service-card">
                        <div class="port">Port 8001</div>
                        <h3>Multimodal Worker</h3>
                        <p>Process images, videos, and text with AI models for embeddings and analysis</p>
                        <a href="#" onclick="switchService('multimodal-worker')">View API</a>
                    </div>
                    <div class="service-card">
                        <div class="port">Port 8002</div>
                        <h3>Retrieval Proxy</h3>
                        <p>Unified search across multimodal content with context bundling</p>
                        <a href="#" onclick="switchService('retrieval-proxy')">View API</a>
                    </div>
                    <div class="service-card">
                        <div class="port">Port 8003</div>
                        <h3>AI Agents</h3>
                        <p>LangChain-based autonomous agents with multimodal capabilities</p>
                        <a href="#" onclick="switchService('ai-agents')">View API</a>
                    </div>
                </div>

                <div class="quick-start">
                    <h3>ðŸš€ Quick Start Examples</h3>
                    
                    <div class="endpoint-example">
                        <h4><span class="method">POST</span><span class="url">/v1/chat/completions</span></h4>
                        <p>Create a chat completion using the LiteLLM Router:</p>
                        <div class="code-block">
curl -X POST http://localhost:4000/v1/chat/completions \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer sk-your-litellm-key" \\
  -d '{
    "model": "gpt-3.5-turbo",
    "messages": [
      {"role": "user", "content": "Hello, how are you?"}
    ],
    "max_tokens": 150,
    "temperature": 0.7
  }'
                        </div>
                    </div>

                    <div class="endpoint-example">
                        <h4><span class="method">POST</span><span class="url">/api/v1/process/image</span></h4>
                        <p>Process an image with the Multimodal Worker:</p>
                        <div class="code-block">
curl -X POST http://localhost:8001/api/v1/process/image \\
  -F "file=@/path/to/image.jpg" \\
  -F "document_name=my_image.jpg"
                        </div>
                    </div>

                    <div class="endpoint-example">
                        <h4><span class="method">POST</span><span class="url">/api/v1/search</span></h4>
                        <p>Search across multimodal content with the Retrieval Proxy:</p>
                        <div class="code-block">
curl -X POST http://localhost:8002/api/v1/search \\
  -H "Content-Type: application/json" \\
  -d '{
    "query": "artificial intelligence machine learning",
    "modalities": ["text", "image", "video"],
    "limit": 10
  }'
                        </div>
                    </div>

                    <div class="endpoint-example">
                        <h4><span class="method">POST</span><span class="url">/api/v1/agents</span></h4>
                        <p>Create an AI agent with the AI Agents service:</p>
                        <div class="code-block">
curl -X POST http://localhost:8003/api/v1/agents \\
  -H "Content-Type: application/json" \\
  -d '{
    "name": "Research Assistant",
    "goal": "Help users research topics and find relevant information",
    "tools": ["web_search", "document_analysis"],
    "memory_window": 10
  }'
                        </div>
                    </div>
                </div>
            `;
            
            // Insert custom content at the beginning
            swaggerContainer.insertBefore(customHeader, swaggerContainer.firstChild);
        }

        // Switch between services
        function switchService(serviceKey) {
            document.getElementById('service-select').value = serviceKey;
            loadService(serviceKey);
        }

        // Load a specific service
        function loadService(serviceKey) {
            // Clear existing content
            document.getElementById('swagger-ui').innerHTML = '';
            
            // Initialize with new service
            initSwaggerUI(serviceKey);
        }

        // Handle service selector change
        document.getElementById('service-select').addEventListener('change', function(e) {
            loadService(e.target.value);
        });

        // Initialize with combined view
        initSwaggerUI('combined');
    </script>
</body>
</html>