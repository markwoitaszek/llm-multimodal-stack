# Environment Variables Reference

This document provides a comprehensive reference for all environment variables used in the Multimodal LLM Stack.

## Overview

The Multimodal LLM Stack uses environment variables for configuration, making it easy to deploy across different environments (development, staging, production) without modifying code or Docker Compose files.

## Environment File Structure

- **`env.example`** - Template with all available environment variables
- **`.env`** - Your local environment configuration (generated by `setup_secrets.py`)
- **`.env.development`** - Development-specific overrides
- **`.env.production`** - Production-specific overrides

## Database Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `POSTGRES_DB` | `multimodal` | PostgreSQL database name |
| `POSTGRES_USER` | `postgres` | PostgreSQL username |
| `POSTGRES_PASSWORD` | *auto-generated* | PostgreSQL password |
| `POSTGRES_HOST` | `postgres` | PostgreSQL host |
| `POSTGRES_PORT` | `5432` | PostgreSQL port |

## Storage Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `MINIO_ROOT_USER` | `minioadmin` | MinIO admin username |
| `MINIO_ROOT_PASSWORD` | *auto-generated* | MinIO admin password |
| `MINIO_PORT` | `9000` | MinIO API port |
| `MINIO_CONSOLE_PORT` | `9002` | MinIO console port |

## Model Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `VLLM_MODEL` | `microsoft/DialoGPT-medium` | LLM model to load |
| `VLLM_API_KEY` | *auto-generated* | API key for vLLM |
| `VLLM_HOST` | `0.0.0.0` | vLLM host |
| `VLLM_PORT` | `8000` | vLLM port |
| `VLLM_GPU_MEMORY_UTILIZATION` | `0.8` | GPU memory utilization |
| `VLLM_MAX_MODEL_LEN` | `1024` | Maximum model length |
| `VLLM_MAX_NUM_SEQS` | `8` | Maximum number of sequences |

## LiteLLM Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `LITELLM_MASTER_KEY` | *auto-generated* | Master key for LiteLLM |
| `LITELLM_SALT_KEY` | *auto-generated* | Salt key for encryption |
| `LITELLM_PORT` | `4000` | LiteLLM port |

## Service Ports

| Variable | Default | Description |
|----------|---------|-------------|
| `MULTIMODAL_WORKER_PORT` | `8001` | Multimodal worker service |
| `RETRIEVAL_PROXY_PORT` | `8002` | Retrieval proxy service |
| `AI_AGENTS_PORT` | `8003` | AI agents service |
| `SEARCH_ENGINE_PORT` | `8004` | Search engine service |
| `MEMORY_SYSTEM_PORT` | `8005` | Memory system service |
| `USER_MANAGEMENT_PORT` | `8006` | User management service |
| `IDE_BRIDGE_PORT` | `8007` | IDE bridge service |
| `N8N_MONITORING_PORT` | `8008` | n8n monitoring service |
| `OPENWEBUI_PORT` | `3030` | OpenWebUI interface |
| `N8N_PORT` | `5678` | n8n workflow platform |
| `REALTIME_COLLABORATION_PORT` | `3006` | Real-time collaboration service |

## Additional Service Ports

| Variable | Default | Description |
|----------|---------|-------------|
| `IDE_BRIDGE_WEB_PORT` | `3002` | IDE bridge web interface |
| `N8N_MONITORING_DASHBOARD_PORT` | `3003` | n8n monitoring dashboard |
| `QDRANT_HTTP_PORT` | `6333` | Qdrant HTTP port |
| `QDRANT_GRPC_PORT` | `6334` | Qdrant gRPC port |
| `REDIS_PORT` | `6379` | Redis port |

## Service Hosts

| Variable | Default | Description |
|----------|---------|-------------|
| `QDRANT_HOST` | `qdrant` | Qdrant host |
| `REDIS_HOST` | `redis` | Redis host |
| `MINIO_ENDPOINT` | `minio:9000` | MinIO endpoint |
| `IDE_BRIDGE_HOST` | `0.0.0.0` | IDE bridge host |
| `N8N_MONITORING_HOST` | `0.0.0.0` | n8n monitoring host |
| `N8N_HOST` | `localhost` | n8n host |

## Service URLs (Internal Communication)

| Variable | Default | Description |
|----------|---------|-------------|
| `MULTIMODAL_WORKER_URL` | `http://multimodal-worker:8001` | Multimodal worker URL |
| `RETRIEVAL_PROXY_URL` | `http://retrieval-proxy:8002` | Retrieval proxy URL |
| `SEARCH_ENGINE_URL` | `http://search-engine:8004` | Search engine URL |
| `MEMORY_SYSTEM_URL` | `http://memory-system:8005` | Memory system URL |
| `USER_MANAGEMENT_URL` | `http://user-management:8006` | User management URL |
| `LLM_BASE_URL` | `http://vllm:8000/v1` | LLM base URL |
| `OPENAI_API_BASE_URL` | `http://vllm:8000/v1` | OpenWebUI API base URL |
| `AI_AGENTS_URL` | `http://ai-agents:8003` | AI agents URL |
| `IDE_BRIDGE_URL` | `http://ide-bridge:8007` | IDE bridge URL |
| `N8N_URL` | `http://n8n:5678` | n8n URL |

## Security Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `JWT_SECRET_KEY` | *auto-generated* | JWT secret for authentication |
| `WEBUI_SECRET_KEY` | *auto-generated* | OpenWebUI secret key |
| `N8N_PASSWORD` | *auto-generated* | n8n admin password |
| `N8N_ENCRYPTION_KEY` | *auto-generated* | n8n encryption key |
| `IDE_BRIDGE_SECRET_KEY` | *auto-generated* | IDE bridge secret key |
| `N8N_MONITORING_SECRET_KEY` | *auto-generated* | n8n monitoring secret key |

## GPU Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `CUDA_VISIBLE_DEVICES` | `0,1` | GPU devices to use |

## Cache Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `CACHE_TTL_SEARCH_RESULTS` | `3600` | Search results cache TTL (seconds) |
| `CACHE_TTL_MODEL_METADATA` | `86400` | Model metadata cache TTL (seconds) |
| `CACHE_TTL_EMBEDDINGS` | `86400` | Embeddings cache TTL (seconds) |
| `CACHE_TTL_AGENT_MEMORY` | `2592000` | Agent memory cache TTL (seconds) |

## Health Check Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `HEALTH_CHECK_INTERVAL` | `30s` | Health check interval |
| `HEALTH_CHECK_TIMEOUT` | `10s` | Health check timeout |
| `HEALTH_CHECK_RETRIES` | `3` | Health check retries |
| `HEALTH_CHECK_START_PERIOD` | `30s` | Health check start period |

## Development Configuration

| Variable | Default | Description |
|----------|---------|-------------|
| `DEBUG` | `false` | Enable debug mode |
| `MODELS_PATH` | `./models` | Path to model files |

## Usage Examples

### Custom Port Configuration

```bash
# Use custom ports for services
export VLLM_PORT=9000
export LITELLM_PORT=5000
export OPENWEBUI_PORT=4000

# Start the stack
docker-compose up -d
```

### Custom Service URLs

```bash
# Use custom service URLs for external services
export LLM_BASE_URL=https://api.external-llm.com/v1
export MULTIMODAL_WORKER_URL=https://worker.external.com:8001

# Start the stack
docker-compose up -d
```

### Production Configuration

```bash
# Production environment variables
export DEBUG=false
export POSTGRES_PASSWORD=super_secure_password_123
export JWT_SECRET_KEY=production_jwt_secret_key_456
export VLLM_GPU_MEMORY_UTILIZATION=0.9

# Start the stack
docker-compose up -d
```

## Environment-Specific Overrides

### Development

```bash
# .env.development
DEBUG=true
VLLM_PORT=8000
LITELLM_PORT=4000
```

### Staging

```bash
# .env.staging
DEBUG=false
VLLM_PORT=9000
LITELLM_PORT=5000
```

### Production

```bash
# .env.production
DEBUG=false
VLLM_PORT=8000
LITELLM_PORT=4000
POSTGRES_PASSWORD=production_secure_password
```

## Best Practices

1. **Never commit `.env` files** to version control
2. **Use strong passwords** for production environments
3. **Rotate secrets regularly** in production
4. **Use environment-specific** configuration files
5. **Validate environment variables** before starting services
6. **Document custom configurations** for your team

## Troubleshooting

### Common Issues

1. **Port conflicts**: Check if ports are already in use
2. **Missing environment variables**: Ensure all required variables are set
3. **Invalid URLs**: Verify service URLs are correctly formatted
4. **Permission issues**: Check file permissions for environment files

### Validation

```bash
# Check if all required environment variables are set
python3 -c "
import os
required_vars = ['POSTGRES_PASSWORD', 'JWT_SECRET_KEY', 'VLLM_API_KEY']
missing = [var for var in required_vars if not os.getenv(var)]
if missing:
    print(f'Missing required variables: {missing}')
else:
    print('All required variables are set')
"
```

## See Also

- [Configuration Guide](configuration.md)
- [Quick Start Guide](quick-start.md)
- [Deployment Guide](development-deployment.md)
- [Troubleshooting Guide](troubleshooting.md)
